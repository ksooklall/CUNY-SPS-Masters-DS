---
title: "Difference between Anomaly and Outliers"
author: "Kenan Sooklall"
output:
  html_document: default
  pdf_document: default
---
```{r, echo=FALSE, warnings=FALSE, output=FALSE, message=FALSE}
library(tidyverse)
library(ggplot2)
```

## Outlier 
A legitimate data point that is far away from the mean or median in a distribution.

## Anomaly 
An illegitimate data point that's generated by a different process than whatever generated the rest of the data.

--------------------------------------------------------------------------------
\clearpage

Let's take a hypothetical example
A recent data breach has happened at a big bank and a customer called stating he account might have 

```{r, echo=FALSE}
df <- data.frame(item=rep(c('bagle', 'coffee', 'apple', 'water', 'sandwich'), 10), cost=rep(c(2.50, 1.50, 0.65, 2.5, 5.50), 10))
df <- rbind(df, c('4k_tv', 799.99))
df <- rbind(df, c('sandwich', 6.00))
df$cost <- as.numeric(df$cost)
#df <- data.frame(df)
head(df, 30)
```

\clearpage

### The Outlier
Outliers are easy to detect because they can be explicitly defined.

 - All values outside 3$\sigma$
 - Values outside $1.5 \pm IQR$

Here we first try values outside 1 std, first scale the data then plot the histogram

```{r, echo=FALSE}
df$scale <- abs(scale(df$cost)[,1])
df$scale %>% hist()
```

Imagine if this was a normal distribution that was right skewed the outlier is very obvious. Filter for values greater than 1.

```{r, echo=FALSE}
df %>% filter(scale > 1)
```

\clearpage
### The Anomaly

But how would you find the Anomaly or even if it exists

```{r, echo=FALSE}
df %>% ggplot(aes(x=item, y=cost)) + geom_col()
```

Everything looks normal and everything else is accounted for.

Try plotting it color change based on prices
```{r, echo=FALSE}
df %>% filter(scale < 2) %>% ggplot(aes(x=item, y=cost, fill=cost)) + geom_col()
```

The light blue at the top of the sandwich bar stand out, filter the data on item==sandwich

```{r, echo=FALSE}
df %>% filter(item == 'sandwich')
```

Make a request to the accounting department to get location data and replot

```{r, echo=FALSE}
df$location <- c(rep(c('US'), 51), 'NK')
df %>% filter(scale < 2) %>% ggplot(aes(x=item, y=cost, fill=location)) + geom_col()
```

BAM!!! The anomaly found, the $6 cost wasn't done by the customer

\clearpage

### Read world problems and cases

Kaggle [creditcardfraud](https://www.kaggle.com/mlg-ulb/creditcardfraud)
This dataset presents transactions that occurred in two days, where we have *492* frauds out of *284,807* transactions. The dataset is highly unbalanced, the positive class (frauds) account for **0.172%** of all transactions. A *return False* model will have 99.828%

[Fradulent_cases](https://www.fincen.gov/resources/law-enforcement/case-examples?field_tags_investigation_target_id=678) that went to trial